!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.validator=r()}(this,function(){"use strict";var e={email:function(e){return/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e)},max:function(e,r){return e=+e,!isNaN(e)&&e<=r},maxlength:function(e,r){return!e||e.length<=r},min:function(e,r){return e=+e,!isNaN(e)&&e>=r},minlength:function(e,r){return e&&e.length>=r},number:function(e){return""!=e&&e==+e&&isFinite(e)},regex:function(e,r){return!!r&&new RegExp(r).test(e)},required:function(e){return void 0!==e&&null!==e&&""!==e}},r=function(e,r){this.success=e,this.errors=r};r.prototype={ok:function(){return!!this.success},getErrors:function(){return this.errors||[]},getFirstError:function(){return this.errors&&this.errors[0]||null}};var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=(function(){function e(e){this.value=e}function r(r){function n(o,i){try{var u=r[o](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):t(u.done?"return":"normal",u.value)}catch(e){t("throw",e)}}function t(e,r){switch(e){case"return":o.resolve({value:r,done:!0});break;case"throw":o.reject(r);break;default:o.resolve({value:r,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,r){return new Promise(function(t,u){var a={key:e,arg:r,resolve:t,reject:u,next:null};i?i=i.next=a:(o=i=a,n(e,r))})},"function"!=typeof r.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)}}(),function(r,n,t){var o=r[n],i=t.rule,u=t.errorMsg,a=t.params,s=i;if("string"==typeof s&&!(s=e[i]))return{name:n,message:"无此校验规则:"+s};var f=[o];return void 0!==a&&(Array.isArray(a)?f.push.apply(f,a):f.push(a)),s.apply(r,f)?null:{name:n,message:u}});return{validate:function(e,n){if(!e||!n)return new r(!1,["校验缺少参数"]);var o=[];return Object.keys(n).forEach(function(r){var i=n[r];if(Array.isArray(i))i.forEach(function(n){var i=t(e,r,n);i&&o.push(i)});else{var u=t(e,r,i);u&&o.push(u)}}),new r(0===o.length,o)},register:function r(t){if(!t||"object"!==(void 0===t?"undefined":n(t)))return console.error("register rule failed: must be an object or an array"),!1;if(Array.isArray(t)){var o=!0;return t.forEach(function(e){r(e)||(o=!1)}),o}var i=t.name;if(!i)return console.error("register rule failed: no name specified"),!1;if(e[i])return console.error("register rule failed: duplicate name"),!1;var u=t.validate;return u&&"function"==typeof u?(e[i]=u,!0):(console.error("register rule failed: no validate function specified"),!1)}}});
